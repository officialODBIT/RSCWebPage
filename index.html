<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RSC — Official Site</title>
  <link rel="stylesheet" href="styles.css">

  <!-- Firebase scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCQLM5dle_c3ZEdK4SrxwE4FRj2KOLoVDU",
      authDomain: "rsc-sd-b-a-d.firebaseapp.com",
      projectId: "rsc-sd-b-a-d",
      storageBucket: "rsc-sd-b-a-d.firebasestorage.app",
      messagingSenderId: "304652298603",
      appId: "1:304652298603:web:bdcb6e1c1f6e10de4b842e",
      measurementId: "G-EX1Y501C6Z"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.submitRSCReport = async function() {
      const urlInput = document.getElementById('resourceUrl').value.trim();
      const bodyInput = document.getElementById('reportDesc').value.trim();

      if (!urlInput || !bodyInput) {
        alert('Please fill in all fields before submitting.');
        return;
      }

      // Random report number (e.g. 6-digit)
      const reportNum = Math.floor(100000 + Math.random() * 900000);

      try {
        await addDoc(collection(db, "reports"), {
          reporturl: urlInput,
          reportnum: reportNum,
          reportbody: bodyInput,
          createdAt: new Date()
        });
        alert(`Report #${reportNum} submitted successfully.`);
        // Clear inputs
        document.getElementById('resourceUrl').value = '';
        document.getElementById('reportDesc').value = '';
      } catch (e) {
        alert("Failed to submit report: " + e.message);
      }
    };
  </script>

</head>
<body>
  <header class="top-banner" role="banner">
    <div class="banner-left">
      <span class="banner-title">An official website of the RSC</span>
    </div>
    <nav class="banner-nav" role="navigation" aria-label="Main navigation">
      <a class="nav-btn" href="/filereport" data-path="/filereport">File a RSC License Violation</a>
      <a class="nav-btn" href="/abt" data-path="/abt">About</a>
      <a class="nav-btn" href="/utils" data-path="/utils">Utilities</a>
    </nav>
  </header>

  <main id="content" role="main">
    <section id="home" class="page" hidden>
      <h2>Welcome to RSC</h2>
      <p>This is the Random Stuff/Stuff Community official landing page. Use the buttons above to navigate.</p>
    </section>

    <section id="filereport" class="page" hidden>
      <h2>File a RSC License Violation</h2>
      <p>If you believe someone violated the RSC License, fill the details below.</p>
      <form id="reportForm" onsubmit="return false;">
        <label>Reported Resource URL<br>
          <input type="text" id="resourceUrl" placeholder="https://example.com/asset" />
        </label>
        <br>
        <label>Description<br>
          <textarea id="reportDesc" rows="6" placeholder="Explain the violation..."></textarea>
        </label>
        <br>
        <button type="button" class="action-btn" id="fakeSubmit">Submit Report</button>
      </form>
    </section>

    <section id="abt" class="page" hidden>
      <h2>About RSC</h2>
      <p>RSC — Random Stuff/Stuff Community — is a community-run collective for sharing small personal projects. The RSC License governs redistribution of code and assets.</p>
    </section>

    <section id="utils" class="page" hidden>
      <h2>Utilities</h2>
      <ul>
        <li><strong>License checker</strong> — (demo) verify license text</li>
        <li><strong>Contact</strong> — reach out to the RSC admins</li>
      </ul>
    </section>
  </main>

  <footer class="site-footer" role="contentinfo">
    <small>© 2025 Random Stuff Community</small>
  </footer>

  <script src="script.js"></script>
  <script>
    // Override previous demo submit button behavior
    document.getElementById('fakeSubmit').addEventListener('click', () => {
      window.submitRSCReport();
    });
  </script>
</body>
</html>
